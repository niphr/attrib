<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generates simulations of expected mortality by simulating the model coefficients. — sim • attrib</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generates simulations of expected mortality by simulating the model coefficients. — sim"><meta name="description" content="With the given fit from fit_attrib the function sim, from package arm, is used to generate 500 simulations
of all the coefficients, from there respective posterior distributions.
This is then used to compute the expected response for all simulations and rows in the input dataset."><meta property="og:description" content="With the given fit from fit_attrib the function sim, from package arm, is used to generate 500 simulations
of all the coefficients, from there respective posterior distributions.
This is then used to compute the expected response for all simulations and rows in the input dataset."><meta property="og:image" content="https://www.csids.no/attrib/logo.png"><script data-goatcounter="https://csidsno.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">
    <a href="https://www.csids.no" class="external-link"><img src="https://www.csids.no/resources/logo/logo_full_white.svg" id="csidslogo"></a>
    <a class="navbar-brand me-2" href="../index.html">attrib</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2025.8.20</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/attrib.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/nowcast.html">Nowcasting with Attrib</a></li>
    <li><a class="dropdown-item" href="../articles/statistical_properties.html">Statistical properties used in Attrib</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://www.csids.no/">Home</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-packages"><li><a class="external-link dropdown-item" href="https://www.csids.no/packages.html">Introduction</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Analysis planning</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.csids.no/org/">org</a></li>
    <li><a class="external-link dropdown-item" href="https://www.csids.no/plnr/">plnr</a></li>
    <li><a class="external-link dropdown-item" href="https://www.csids.no/cs9/">cs9</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Helper functions</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.csids.no/csdb/">csdb</a></li>
    <li><a class="external-link dropdown-item" href="https://www.csids.no/csstyle/">csstyle</a></li>
    <li><a class="external-link dropdown-item" href="https://www.csids.no/cstidy/">cstidy</a></li>
    <li><a class="external-link dropdown-item" href="https://www.csids.no/cstime/">cstime</a></li>
    <li><a class="external-link dropdown-item" href="https://www.csids.no/csutil/">csutil</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Surveillance</h6></li>
    <li><a class="dropdown-item" href="https://www.csids.no/attrib/">attrib</a></li>
    <li><a class="external-link dropdown-item" href="https://www.csids.no/csalert/">csalert</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Structural data</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.csids.no/csdata/">csdata</a></li>
    <li><a class="external-link dropdown-item" href="https://www.csids.no/csmaps/">csmaps</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-about" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">About</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-about"><li><a class="external-link dropdown-item" href="https://www.csids.no/about.html">About CSIDS</a></li>
    <li><a class="external-link dropdown-item" href="https://www.csids.no/get_involved.html">Get involved</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/csids/attrib/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generates simulations of expected mortality by simulating the model coefficients.</h1>
      <small class="dont-index">Source: <a href="https://github.com/csids/attrib/blob/HEAD/R/sim.R" class="external-link"><code>R/sim.R</code></a></small>
      <div class="d-none name"><code>sim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>With the given fit from fit_attrib the function sim, from package arm, is used to generate 500 simulations
of all the coefficients, from there respective posterior distributions.
This is then used to compute the expected response for all simulations and rows in the input dataset.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sim</span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, <span class="va">n_sim</span>, PI <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fit">fit<a class="anchor" aria-label="anchor" href="#arg-fit"></a></dt>
<dd><p>A model fit created by fit_attrib</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The data with either observed values or reference values.</p></dd>


<dt id="arg-n-sim">n_sim<a class="anchor" aria-label="anchor" href="#arg-n-sim"></a></dt>
<dd><p>Number of simulations</p></dd>


<dt id="arg-pi">PI<a class="anchor" aria-label="anchor" href="#arg-pi"></a></dt>
<dd><p>Returns a draw from the quasipoisson distribution with the calculated mean as mean. If false the exponential of the mean is returned.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A dataset with 500 simulations of the expected response for each row in the original dataset.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>vignette("intro", package="attrib")</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">response</span> <span class="op">&lt;-</span> <span class="st">"deaths_n"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fixef</span> <span class="op">&lt;-</span> <span class="st">"ili_isoweekmean7_13_pr100 +</span></span></span>
<span class="r-in"><span><span class="st">  sin(2 * pi * (isoweek - 1) / 52) +</span></span></span>
<span class="r-in"><span><span class="st">  cos(2 * pi * (isoweek - 1) / 52)"</span></span></span>
<span class="r-in"><span><span class="va">ranef</span> <span class="op">&lt;-</span> <span class="st">" (ili_isoweekmean7_13_pr100| season)"</span></span></span>
<span class="r-in"><span><span class="va">offset</span> <span class="op">&lt;-</span> <span class="st">"log(pop_jan1_n)"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">attrib</span><span class="fu">::</span><span class="va"><a href="data_fake_attrib_nation.html">data_fake_attrib_nation</a></span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="fit_attrib.html">fit_attrib</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, response <span class="op">=</span> <span class="va">response</span>, fixef <span class="op">=</span> <span class="va">fixef</span>, ranef <span class="op">=</span> <span class="va">ranef</span>, offset <span class="op">=</span> <span class="va">offset</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> boundary (singular) fit: see help('isSingular')</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n_sim</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="fu">sim</span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, <span class="va">n_sim</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       location_code isoyear isoweek isoyearweek    season seasonweek pop_jan1_n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              &lt;char&gt;   &lt;int&gt;   &lt;int&gt;      &lt;char&gt;    &lt;char&gt;      &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:    nation_nor    2009      30     2009-30 2009/2010          1    5367580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:    nation_nor    2009      31     2009-31 2009/2010          2    5367580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:    nation_nor    2009      32     2009-32 2009/2010          3    5367580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:    nation_nor    2009      33     2009-33 2009/2010          4    5367580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:    nation_nor    2009      34     2009-34 2009/2010          5    5367580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2866:    nation_nor    2020      25     2020-25 2019/2020         48    5367580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2867:    nation_nor    2020      26     2020-26 2019/2020         49    5367580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2868:    nation_nor    2020      27     2020-27 2019/2020         50    5367580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2869:    nation_nor    2020      28     2020-28 2019/2020         51    5367580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2870:    nation_nor    2020      29     2020-29 2019/2020         52    5367580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ili_isoweekmean0_6_pr100 ili_isoweekmean7_13_pr100 heatwavedays_n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          &lt;num&gt;                     &lt;num&gt;          &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:             8.989140e-07              0.000000e+00     0.81818182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:             2.524744e-06              8.989140e-07     0.54545455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:             6.818846e-06              2.524744e-06     0.36363636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:             1.771046e-05              6.818846e-06     0.54545455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:             4.423928e-05              1.771046e-05     0.36363636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2866:             2.433569e-03              4.808987e-03     0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2867:             1.184660e-03              2.433569e-03     0.18181818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2868:             5.547034e-04              1.184660e-03     0.36363636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2869:             2.498084e-04              5.547034e-04     0.09090909</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2870:             1.081928e-04              2.498084e-04     0.90909091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       deaths_n id_row sim_id sim_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;int&gt;  &lt;int&gt;  &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:      827      1      1  785.1130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:      751      2      1  786.7189</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:      811      3      1  788.6452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:      787      4      1  790.8664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:      828      5      1  793.3524</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2866:      791    570      5  778.7174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2867:      787    571      5  778.3289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2868:      785    572      5  778.3929</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2869:      754    573      5  778.8821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2870:      770    574      5  779.7753</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p><a href="https://www.csids.no" class="external-link"><img src="https://www.csids.no/resources/logo/logo_full_blue.svg" width="200"></a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Crafted by <a href="https://www.rwhite.no" class="external-link">Richard Aubrey White</a>, Aurora Christine Hofman.</p>
</div>

    </footer></div>





  </body></html>

